(this["webpackJsonpmachinemax-test"]=this["webpackJsonpmachinemax-test"]||[]).push([[0],{109:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},159:function(e,t,a){e.exports=a(280)},164:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},165:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},166:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},172:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},274:function(e,t,a){},275:function(e,t,a){e.exports={operationOn:"#00b159",operationIdle:"#e5e500",operationOff:"#666"}},280:function(e,t,a){"use strict";a.r(t);var n,c=a(1),r=a.n(c),i=a(75),s=a.n(i),o=(a(164),a(52)),l=(a(165),a(166),a(21)),u=a(11),m=a.n(u),d=a(12),p="POLL_MACHINES_START",h="POLL_MACHINES_STOP",f="POLL_MACHINE_BY_ID_START",E="POLL_MACHINE_BY_ID_STOP",v=a(62),b=a(155),_=a(79),O=a(78),g=a(141),y=a(154),I=function(e){function t(e,a){var n;return Object(v.a)(this,t),(n=Object(b.a)(this,Object(_.a)(t).call(this,e))).httpStatus=void 0,n.httpStatus=a,Object.setPrototypeOf(Object(O.a)(n),(this instanceof t?this.constructor:void 0).prototype),n}return Object(g.a)(t,e),t}(Object(y.a)(Error));n="https://cors-anywhere.herokuapp.com/dummy-hacxuuktha-ew.a.run.app";var N=function e(){Object(v.a)(this,e)};N.fetch=function(e,t){var a;return m.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,m.a.awrap(fetch(n+e,t));case 2:if(a=c.sent,(r=a).status>=200&&r.status<204){c.next=5;break}throw new I("Http error occurred",a.status);case 5:return c.abrupt("return",a.json());case 6:case"end":return c.stop()}var r}))};var x,j;!function(e){e.Active="ACTIVE",e.Idle="IDLE",e.Off="OFF"}(x||(x={})),function(e){e.Active="active",e.Problem="problem"}(j||(j={}));var S=function e(){Object(v.a)(this,e)};S.getAll=function(){return m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.awrap(N.fetch("/machines"));case 2:return e.abrupt("return",e.sent.machines);case 3:case"end":return e.stop()}}))},S.getById=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.awrap(N.fetch("/machines/"+e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))},S.getHistory=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.awrap(N.fetch("/machines/"+e+"/history"));case 2:return t.abrupt("return",t.sent.history);case 3:case"end":return t.stop()}}))};var H=function(e){return new Promise((function(t){setTimeout((function(){return t(!0)}),e)}))},w=m.a.mark(B),A=m.a.mark(D),C=m.a.mark(U),T=m.a.mark(Y),M=function(){return{type:"GET_MACHINES_REQUEST"}},L=function(e){return{type:"GET_MACHINES_SUCCESS",payload:{machines:e}}},k=function(){return{type:"GET_MACHINES_FAIL"}};function B(){var e;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Object(d.c)(M());case 4:return t.next=6,Object(d.b)((function(){return S.getAll()}));case 6:return e=t.sent,t.next=9,Object(d.c)(L(e));case 9:return t.next=11,Object(d.b)(H,3e4);case 11:t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(1),t.next=17,Object(d.c)(k(t.t0));case 17:t.next=0;break;case 19:case"end":return t.stop()}}),w,null,[[1,13]])}function D(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(d.e)(p);case 3:return e.next=5,Object(d.d)([Object(d.b)(B),Object(d.e)(h)]);case 5:e.next=0;break;case 7:case"end":return e.stop()}}),A)}var F=function(e){return{type:"GET_MACHINE_BY_ID_REQUEST",payload:{id:e}}},G=function(e){return{type:"GET_MACHINE_BY_ID_SUCCESS",payload:{machine:e}}},R=function(){return{type:"GET_MACHINE_BY_ID_FAIL"}};function U(e){var t;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=1,a.next=4,Object(d.c)(F(e.payload.id));case 4:return a.next=6,Object(d.b)((function(){return S.getById(e.payload.id)}));case 6:return t=a.sent,a.next=9,Object(d.c)(G(t));case 9:return a.next=11,Object(d.b)(H,3e4);case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(1),a.next=17,Object(d.c)(R(a.t0));case 17:a.next=0;break;case 19:case"end":return a.stop()}}),C,null,[[1,13]])}function Y(){var e;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(d.e)(f);case 3:return e=t.sent,t.next=6,Object(d.d)([Object(d.b)(U,e),Object(d.e)(E)]);case 6:t.next=0;break;case 8:case"end":return t.stop()}}),T)}var P=function(e,t){return{type:"GET_MACHINE_HISTORY_SUCCESS",payload:{machineHistory:e,id:t}}},Q=a(39),W=a.n(Q),J=a(43),V=a(287),$=a(291),q=(a(172),a(109)),z=function(e){var t=e.machine,a=t.activity.activeHours,n=t.activity.idleHours,c=a+n,i=24-c,s=[],o=[];return a>0&&(s.push({x:"On: "+a.toFixed(1),y:a}),o.push(q.operationOn)),n>0&&(s.push({x:"Idle "+n.toFixed(1),y:n}),o.push(q.operationIdle)),i>0&&(s.push({x:"Off "+i.toFixed(1),y:i}),o.push(q.operationOff)),r.a.createElement("div",{className:"machine-tile"},r.a.createElement("div",{className:"machine-tile__name"},r.a.createElement("div",null,r.a.createElement(J.b,{to:"/".concat(t.id)},r.a.createElement("b",null,t.type+" "+t.name))),r.a.createElement("div",null,t.group)),r.a.createElement("div",{className:"machine-tile__info"},r.a.createElement(J.b,{className:"machine-tile__thumbnail-link",to:"/".concat(t.id)},r.a.createElement("img",{src:t.thumbURL,alt:""})),r.a.createElement("div",{className:"machine-tile__status-chart"},r.a.createElement(re.Consumer,null,(function(e){return r.a.createElement(V.a,{colorScale:o,height:170,width:220,startAngle:-90,endAngle:90,data:s,labelRadius:70,radius:50,style:{labels:{fill:e?"#ddd":"#333"}},containerComponent:r.a.createElement($.a,{responsive:!0})})})))),r.a.createElement("div",{className:"machine-tile__name"},r.a.createElement("div",null,"sensor: ",t.sensorID),r.a.createElement("div",null,r.a.createElement("b",null,"total: ",c.toFixed(1)," hrs"))))},K=(a(274),function(e){var t=e.status;return r.a.createElement("div",{className:"server-status server-status--".concat(t)})}),X=function(){var e=Object(l.c)((function(e){return e.machines.machines})).sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),t=Object(l.c)((function(e){return e.machines.machinesLoadedLast})),a=Object(l.c)((function(e){return e.machines.machinesEndpointStatus})),n=Object(l.b)(),i=Object(c.useState)(""),s=Object(o.a)(i,2),u=s[0],m=s[1],d=Object(c.useState)(""),f=Object(o.a)(d,2),E=f[0],v=f[1],b=Object(c.useState)(""),_=Object(o.a)(b,2),O=_[0],g=_[1];Object(c.useEffect)((function(){return n({type:p}),function(){n({type:h})}}),[]);var y=e.filter(function(e){return function(t){return t.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}}(u)).sort(function(e){return function(t,a){return e?a.activity[e]-t.activity[e]:1}}(E)),I=[];y.forEach((function(e){I.indexOf(e.group)<=-1&&I.push(e.group)})),y=y.filter((function(e){return!O||e.group===O}));return r.a.createElement("div",{className:"machines-list"},r.a.createElement("div",{className:"content-area bottom-spacing"},r.a.createElement("h2",{className:"col-lg-12"},"Status for all your machines"),r.a.createElement("div",{className:"col-lg-12 inner-grid-12 column-gap bottom-spacing machines-list__status"},r.a.createElement("div",{className:"col-lg-8"},t?r.a.createElement(r.a.Fragment,null," Accurate as of ",W()(t).format("DD/MMM HH:mm:ss")," "):null),r.a.createElement("div",{className:"col-lg-3 col-sm-8"},"Server status:"),r.a.createElement("div",{className:"col-lg-1 col-sm-4"},r.a.createElement(K,{status:a}))),r.a.createElement("div",{className:"col-lg-12 inner-grid-12 column-gap machines-list__filters"},r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("label",{htmlFor:"#name-fiter"},"Search by name:"),r.a.createElement("input",{id:"name-filter",value:u,onChange:function(e){return m(e.currentTarget.value)}})),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("label",{htmlFor:"#time-sort"},"Sort by active/idle time:"),r.a.createElement("select",{id:"time-sort",value:E,onChange:function(e){return v(e.currentTarget.value)}},r.a.createElement("option",{value:""}),r.a.createElement("option",{value:"activeHours"},"Active time"),r.a.createElement("option",{value:"idleHours"},"Idle time"))),r.a.createElement("div",{className:"col-lg-4"},r.a.createElement("label",{htmlFor:"#site-filter"},"Filter by site:"),r.a.createElement("select",{id:"site-filter",value:O,onChange:function(e){return g(e.currentTarget.value)}},r.a.createElement("option",{value:""}),I.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",{className:"col-lg-12"},r.a.createElement("a",{className:"machines-list__reset-filters",href:"/#",onClick:function(e){e.preventDefault(),m(""),v(""),g("")}},"Reset filters")))),r.a.createElement("div",{className:"content-area column-gap row-gap bottom-spacing"},y.map((function(e){return r.a.createElement("div",{key:e.id,className:"col-lg-4 col-md-6"},r.a.createElement(z,{machine:e}))}))))},Z=a(26),ee=(a(275),a(288)),te=a(109),ae=function(e){var t=new Date(e.start).getTime(),a=0,n="";switch(e.state){case x.Active:a=2,n=te.operationOn;break;case x.Idle:a=-1,n=te.operationIdle;break;case x.Off:a=-.5,n=te.operationOff}return{x:t,y:a,fill:n,label:W()(t).format("HH:mm"),width:new Date(e.end).getTime()-t}},ne=function(e){var t=e.machineHistory;if(!t)return null;var a=t.map(ae);return r.a.createElement("div",{className:"inner-grid-12"},r.a.createElement("div",{className:"col-lg-12"},r.a.createElement(ee.a,{height:300,width:1e3,data:a,style:{data:{fill:function(e){return e.datum.fill}},labels:{fill:"#888"}},barWidth:function(e){return 105e-7*e.datum.width},alignment:"start",labels:function(e){return e.datum.label}})),r.a.createElement("div",{className:"col-lg-12"},r.a.createElement("p",null,"On, Idle and Off status for ",W()(t[0].start).format("ddd DD MMM")," - ",W()(t[t.length-1].end).format("ddd DD MMM"))))},ce=Object(Z.f)((function(e){var t=e.match.params.machineID,a=Object(l.c)((function(e){return e.machines.machineById[t]})),n=Object(l.c)((function(e){return e.machines.machineHistoryById[t]})),i=Object(l.c)((function(e){return e.machines.machineByIdEndpointStatus})),s=Object(l.b)();if(Object(c.useEffect)((function(){return s({type:f,payload:{id:t}}),s(function e(t){return function(a){var n;return m.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a({type:"GET_MACHINE_HISTORY_REQUEST"}),c.prev=1,c.next=4,m.a.awrap(S.getHistory(t));case 4:n=c.sent,a(P(n,t)),c.next=14;break;case 8:return c.prev=8,c.t0=c.catch(1),a((c.t0,{type:"GET_MACHINE_HISTORY_FAIL"})),c.next=13,m.a.awrap(H(1e3));case 13:e(t);case 14:return c.abrupt("return");case 15:case"end":return c.stop()}}),null,null,[[1,8]])}}(t)),function(){s({type:E})}}),[]),a){var o=a.machine,u=a.loadedLast;return r.a.createElement("div",{className:"machine-details"},r.a.createElement("div",{className:"content-area machine-details__content"},r.a.createElement("div",{className:"col-lg-10 col-md-8 col-sm-6 top-spacing bottom-spacing"},r.a.createElement(J.b,{to:"/"},"<"," Home")),r.a.createElement("div",{className:"col-lg-2 col-md-4 col-sm-6 inner-grid-4 top-spacing bottom-spacing"},r.a.createElement("div",{className:"col-lg-3 col-sm-2"},"Server",r.a.createElement("span",{className:"hidden-sm"}," status"),":"),r.a.createElement("div",{className:"col-lg-1 col-sm-2"},r.a.createElement(K,{status:i}))),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("h1",{className:"machine-details__title"},o.type+" "+o.name),r.a.createElement("div",null,r.a.createElement("b",null,o.group)),r.a.createElement("div",{className:"inner-grid-2"},r.a.createElement("div",{className:"col-lg-1"},r.a.createElement("div",{className:"machine-details__operation machine-details__operation--active"},"Active hours: ",o.activity.activeHours.toFixed(2)),r.a.createElement("div",{className:"machine-details__operation machine-details__operation--idle"},"Idle hours: ",o.activity.idleHours.toFixed(2)),r.a.createElement("div",{className:"machine-details__operation machine-details__operation--off"},"Off hours: ",(24-o.activity.activeHours-o.activity.idleHours).toFixed(2))),r.a.createElement("div",{className:"col-lg-1 bottom-spacing"},"Accurate as of ",r.a.createElement("br",{className:"hidden-sm"})," ",W()(u).format("DD/MMM HH:mm:ss")))),r.a.createElement("div",{className:"col-lg-6 text-right"},r.a.createElement("img",{className:"machine-details__photo",src:o.imageURL,alt:""})),r.a.createElement("div",{className:"col-lg-12"},r.a.createElement(ne,{machineHistory:n}))))}return r.a.createElement("div",null,"Loading...")})),re=r.a.createContext(!1);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=a(32),se=a(152),oe=a(105),le=a(153),ue=a(50),me=a(27),de={machines:[],machinesEndpointStatus:j.Active,machineById:{},machineByIdEndpointStatus:j.Active,machineHistoryById:{}},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MACHINES_REQUEST":return e;case"GET_MACHINES_FAIL":return Object(me.a)({},e,{machinesEndpointStatus:j.Problem});case"GET_MACHINES_SUCCESS":return Object(me.a)({},e,{machines:t.payload.machines,machinesLoadedLast:new Date,machinesEndpointStatus:j.Active});case"GET_MACHINE_BY_ID_REQUEST":if(!e.machineById[t.payload.id]){var a=e.machines.find((function(e){return e.id===t.payload.id}));if(a&&e.machinesLoadedLast)return Object(me.a)({},e,{machineById:Object(me.a)({},e.machineById,Object(ue.a)({},t.payload.id,{machine:a,loadedLast:e.machinesLoadedLast}))})}return e;case"GET_MACHINE_BY_ID_FAIL":return Object(me.a)({},e,{machineByIdEndpointStatus:j.Problem});case"GET_MACHINE_BY_ID_SUCCESS":var n=t.payload.machine;return Object(me.a)({},e,{machineById:Object(me.a)({},e.machineById,Object(ue.a)({},n.id,{machine:n,loadedLast:new Date})),machineByIdEndpointStatus:j.Active});case"GET_MACHINE_HISTORY_REQUEST":case"GET_MACHINE_HISTORY_FAIL":return e;case"GET_MACHINE_HISTORY_SUCCESS":var c=t.payload.machineHistory,r=t.payload.id;return Object(me.a)({},e,{machineHistoryById:Object(me.a)({},e.machineHistoryById,Object(ue.a)({},r,c))});default:return e}},he=Object(ie.c)({machines:pe}),fe=m.a.mark(Ee);function Ee(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.a)([D(),Y()]);case 2:case"end":return e.stop()}}),fe)}var ve=Object(le.a)(),be=Object(ie.a)(Object(oe.save)(),ve,se.a)(ie.e)(he,Object(oe.load)());ve.run(Ee),s.a.render(r.a.createElement(l.a,{store:be},r.a.createElement((function(){var e=Object(c.useState)("true"===localStorage.getItem("night-mode")),t=Object(o.a)(e,2),a=t[0],n=t[1];return r.a.createElement(re.Provider,{value:a},r.a.createElement("div",{className:"app".concat(a?" app--night-mode":"")},r.a.createElement("div",{className:"content-area app__mode-container"},r.a.createElement("div",{className:"col-lg-12 text-right"},r.a.createElement("label",{htmlFor:"nightmode",className:"app__mode-selector text-left"},r.a.createElement("span",null,"Night mode:"),r.a.createElement("input",{id:"nightmode",type:"checkbox",value:"night",checked:a,onChange:function(e){var t=e.currentTarget.checked;n(t),localStorage.setItem("night-mode",""+t)}}),r.a.createElement("div",{className:"app__mode-selector__trigger"})))),r.a.createElement(J.a,null,r.a.createElement(Z.c,null,r.a.createElement(Z.a,{exact:!0,path:"/",render:function(){return r.a.createElement(X,null)}}),r.a.createElement(Z.a,{exact:!0,path:"/:machineID",render:function(){return r.a.createElement(ce,null)}})))))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[159,1,2]]]);
//# sourceMappingURL=main.17e5ca75.chunk.js.map